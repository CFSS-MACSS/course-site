<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Reproducible examples and Git</title>
    <meta charset="utf-8" />
    <meta name="author" content="MACS 30500   University of Chicago" />
    <script src="index_files/header-attrs/header-attrs.js"></script>
    <link href="index_files/panelset/panelset.css" rel="stylesheet" />
    <script src="index_files/panelset/panelset.js"></script>
    <link href="index_files/countdown/countdown.css" rel="stylesheet" />
    <script src="index_files/countdown/countdown.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Reproducible examples and Git
]
.author[
### MACS 30500 <br /> University of Chicago
]

---


class: middle





---
# Agenda

* Reproducible examples
* Git / GitHub

---
&lt;img src="https://media.giphy.com/media/uRb2p09vY8lEs/giphy.gif" width="80%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="../../img/allison_horst_art/reprex.png" alt="A side-by-side comparison of a monster providing problematic code to tech support when it is on a bunch of crumpled, disorganized papers, with both monsters looking sad and very stressed (left), compared to victorious looking monsters celebrating when code is provided in a nice box with a bow labeled 'reprex'. Title text reads 'reprex: make reproducible examples. Help them help everyone!'" width="80%" style="display: block; margin: auto;" /&gt;

.footnote[Source: [Allison Horst](https://github.com/allisonhorst/stats-illustrations)]

---

## Reproducible examples

* reprex (noun)
* `reprex`
* `reprex::reprex()`

---

## Why reprexes?

Easier to talk about code that:

* Actually runs

--

* I don't have to run


--

* I can easily run

---

## `reprex`

```r
library(tidyverse)
count(diamonds, colour)
```

---

## Customizing `reprex()`

.panelset[

.panel[

.panel-name[Include session info]

```r
reprex(
  x = mean(rnorm(100)),
  si = TRUE
)
```

]

.panel[

.panel-name[Change venue]

```r
reprex(
  x = mean(rnorm(100)),
  venue = "r"
)
```

]

.panel[

.panel-name[Style the code]

```r
reprex(
  x = {
if (TRUE) "true branch" else {
  "else branch"
}
  },
  style = TRUE
)
```

]

]

---

## Reprex do's and don'ts

* Ensure the example is **fully** reproducible
* Use the smallest, simplest, most built-in data possible
* Include commands on a strict "need to run" basis
* Consider including "session info"
* Use good coding style to ensure the readability of your code by other human beings
* Ensure portability of the code

---

## Build some reproducible examples

&lt;img src="https://media.giphy.com/media/l4Ki2obCyAQS5WhFe/giphy.gif" width="65%" style="display: block; margin: auto;" /&gt;

<div class="countdown" id="timer_e0553ce1" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">15</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

class: center, middle



---

## Git

* Version control system
* Repository (repo)
* GitHub is where we can store / distribute repos
* COMMIT OFTEN!!
  * Think of it as taking a photo do of EVERYTHING to document where you are in your project
  * Try to have a meaningful message to remind yourself what changed (in case you need to go back later!)
* Push somewhat often (people vary on this)


---
## Why use Git? 

--
&lt;img src="https://swcarpentry.github.io/git-novice/fig/phd101212s.png" width="80%" style="display: block; margin: auto;" /&gt;


---
## Git

### What files to commit

* Source files (includes markdown files)
* Configuration files (e.g. gitignore, .Rproj)
* Data files

### What files to not commit

* Temporary files
* Log files
* Files with private details
* Any file greater than 100 megabytes

---

## `.gitignore`

* System file
* Tells Git which files/directories to ignore

---
## Git LFS

* [Git Large File Storage](https://git-lfs.github.com/)
* Separate software for tracking large files
* Integrates with Git
* Generally charges a fee


---

## Pushing / Pulling

**Pushing** is when you are sending your changes to GitHub while **pulling** is when you are 'refreshing' your copy of the files to your machine. 

The order of your workflow matters less when you are working on your own on a project, but when you are collaborating with others, it becomes crucial to have a good workflow. Think of a google doc you are collaboratively editing. You work offline and when you go back online, someone else has made changes, how could you reconcile this? The analogy is trying to push changes without pulling to update your files first. **It is a good habit to pull before starting work, even when working alone.**

---
## Git and merge conflicts
*Typically* these occur when you haven't pulled before pushing changes in a collaborative project. Essentially, there are now two 'current' versions of a file and they need to be reconciled. Sometimes, they can be automatically resolved but sometimes you have to deal with the conflicts. In these instances, you can review the code side-by-side and confirm the changes. (**this option varies by how you interact with Git!**)


---
## Using Git and various interfaces

There are more options to consider XXX


---

# Troubleshooting Git

---

## Accidentally cloned from the main

&lt;img src="https://media.giphy.com/media/3oxHQKW9lw6rK9kYtq/giphy.gif" width="80%" style="display: block; margin: auto;" /&gt;

---

## Accidentally cloned from the main

```bash
remote: Permission to cfss-hmwks/hw03.git denied to cfss-student
fatal: unable to access 'https://github.com/cfss-hmwks/hw03.git/': The requested URL returned error: 403
```

--

```r
usethis::use_git_remote(
  name = "origin",
  url = "&lt;YOUR_FORK_URL&gt;",
  overwrite = TRUE
)
```

---

## Avoiding Git problems

1. Commit early and often
1. Push regularly to GitHub

---

## Burn it all down

&lt;img src="https://imgs.xkcd.com/comics/git.png" width="35%" style="display: block; margin: auto;" /&gt;

.footnote[Source: [xkcd](https://xkcd.com/1597/)]


---

## Recap

1. Commit early and often as you revise and update your project
1. Push regularly to GitHub
1. Each successful push results in a new “worst case scenario”
1. If you screw things up badly on your local machine, copy all the files in your repo to a safe place on your computer (i.e. a new folder)
1. Rename the existing local repository as a temporary measure
1. Clone the repository from GitHub to your local machine. This version of the repository works as intended
1. Copy all relevant files back over from your safe space. That is, the ones whose updated state you need to commit
1. Stage, commit, and push


---

## Acknowledgments 

Materials adapted from Sabrina Nardin and Benjamin Soltoff’s “Computing for the Social Sciences” course materials, licensed under the CC BY NC 4.0 Creative Commons License. Any errors or oversights are mine alone.

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "magula",
"highlightLines": true,
"highlightLanguage": "r",
"ratio": "16:9",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
